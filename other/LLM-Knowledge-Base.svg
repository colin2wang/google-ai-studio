<svg viewBox="0 0 1000 800" xmlns="http://www.w3.org/2000/svg">
  <!-- Background -->
  <rect width="1000" height="800" fill="#f8f9fa" />
  
  <!-- Layer 1: Business/User Layer -->
  <rect x="50" y="30" width="900" height="120" rx="10" fill="#e3f2fd" stroke="#2196f3" stroke-width="2"/>
  <text x="500" y="60" font-family="Arial, sans-serif" font-size="20" font-weight="bold" text-anchor="middle" fill="#0d47a1">业务与用户层 (Business &amp; User Layer)</text>
  
  <!-- Business Nodes -->
  <rect x="100" y="80" width="150" height="50" rx="5" fill="#fff" stroke="#2196f3"/>
  <text x="175" y="110" text-anchor="middle" font-size="14">内部知识助手</text>
  
  <rect x="300" y="80" width="150" height="50" rx="5" fill="#fff" stroke="#2196f3"/>
  <text x="375" y="110" text-anchor="middle" font-size="14">智能客服</text>

  <rect x="500" y="80" width="150" height="50" rx="5" fill="#fff" stroke="#2196f3"/>
  <text x="575" y="110" text-anchor="middle" font-size="14">代码/研发辅助</text>
  
  <rect x="700" y="80" width="150" height="50" rx="5" fill="#bbdefb" stroke="#2196f3"/>
  <text x="775" y="110" text-anchor="middle" font-size="14">用户反馈/埋点</text>

  <!-- Arrow Down -->
  <path d="M500 150 L500 190" stroke="#333" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- Layer 2: Application Orchestration (LangChain/Agent) -->
  <rect x="50" y="200" width="900" height="180" rx="10" fill="#e8f5e9" stroke="#4caf50" stroke-width="2"/>
  <text x="500" y="230" font-family="Arial, sans-serif" font-size="20" font-weight="bold" text-anchor="middle" fill="#1b5e20">应用编排层 (Orchestration Layer)</text>
  
  <!-- Orchestration Logic -->
  <rect x="80" y="250" width="200" height="100" rx="5" fill="#fff" stroke="#4caf50"/>
  <text x="180" y="280" text-anchor="middle" font-weight="bold" font-size="14">查询理解</text>
  <text x="180" y="300" text-anchor="middle" font-size="12">- 意图识别</text>
  <text x="180" y="320" text-anchor="middle" font-size="12">- 关键词提取</text>
  
  <rect x="350" y="250" width="200" height="100" rx="5" fill="#fff" stroke="#4caf50"/>
  <text x="450" y="280" text-anchor="middle" font-weight="bold" font-size="14">上下文组装 (Context)</text>
  <text x="450" y="300" text-anchor="middle" font-size="12">- System Prompt</text>
  <text x="450" y="320" text-anchor="middle" font-size="12">- 召回知识切片</text>

  <rect x="620" y="250" width="200" height="100" rx="5" fill="#fff" stroke="#4caf50"/>
  <text x="720" y="280" text-anchor="middle" font-weight="bold" font-size="14">LLM 推理</text>
  <text x="720" y="300" text-anchor="middle" font-size="12">- GPT/Claude/Llama</text>
  <text x="720" y="320" text-anchor="middle" font-size="12">- 答案生成</text>

  <!-- Arrows Horizontal -->
  <path d="M280 300 L350 300" stroke="#4caf50" stroke-width="2" marker-end="url(#arrow)"/>
  <path d="M550 300 L620 300" stroke="#4caf50" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- Arrow Down to Data -->
  <path d="M450 350 L450 420" stroke="#333" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- Layer 3: Data Processing & Storage (The "Brain") -->
  <rect x="50" y="420" width="900" height="320" rx="10" fill="#fff3e0" stroke="#ff9800" stroke-width="2"/>
  <text x="500" y="450" font-family="Arial, sans-serif" font-size="20" font-weight="bold" text-anchor="middle" fill="#e65100">数据处理与存储层 (Data &amp; Storage Layer)</text>

  <!-- Left: Ingestion Pipeline (Offline) -->
  <rect x="80" y="470" width="380" height="240" rx="5" fill="#fff" stroke="#ff9800" stroke-dasharray="5,5"/>
  <text x="270" y="490" text-anchor="middle" font-weight="bold" fill="#ef6c00">离线数据管道 (ETL Pipeline)</text>

  <rect x="100" y="510" width="100" height="60" rx="5" fill="#ffe0b2" stroke="none"/>
  <text x="150" y="535" text-anchor="middle" font-size="12">原始数据</text>
  <text x="150" y="555" text-anchor="middle" font-size="10">(PDF, Wiki, DB)</text>

  <path d="M200 540 L230 540" stroke="#ff9800" stroke-width="2" marker-end="url(#arrow)"/>

  <rect x="230" y="510" width="100" height="60" rx="5" fill="#ffe0b2" stroke="none"/>
  <text x="280" y="535" text-anchor="middle" font-size="12">清洗与切片</text>
  <text x="280" y="555" text-anchor="middle" font-size="10">(Chunking)</text>

  <path d="M330 540 L360 540" stroke="#ff9800" stroke-width="2" marker-end="url(#arrow)"/>

  <rect x="360" y="510" width="80" height="60" rx="5" fill="#ffe0b2" stroke="none"/>
  <text x="400" y="545" text-anchor="middle" font-size="12">Embedding</text>

  <path d="M400 570 L400 620" stroke="#ff9800" stroke-width="2" marker-end="url(#arrow)"/>
  
  <!-- Vector DB -->
  <rect x="300" y="620" width="200" height="80" rx="5" fill="#ffcc80" stroke="#e65100" stroke-width="2"/>
  <text x="400" y="655" text-anchor="middle" font-weight="bold" font-size="14">向量数据库</text>
  <text x="400" y="675" text-anchor="middle" font-size="12">(Milvus / Chroma)</text>

  <!-- Right: Retrieval Logic (Online) -->
  <rect x="540" y="470" width="380" height="240" rx="5" fill="#fff" stroke="#ff9800" stroke-dasharray="5,5"/>
  <text x="730" y="490" text-anchor="middle" font-weight="bold" fill="#ef6c00">在线检索服务 (Retrieval Service)</text>

  <rect x="580" y="530" width="140" height="50" rx="5" fill="#ffe0b2" stroke="none"/>
  <text x="650" y="560" text-anchor="middle" font-size="12">混合检索 (Hybrid)</text>
  
  <rect x="750" y="530" width="140" height="50" rx="5" fill="#ffe0b2" stroke="none"/>
  <text x="820" y="560" text-anchor="middle" font-size="12">重排序 (Rerank)</text>

  <!-- Connection Logic -->
  <path d="M500 660 L580 560" stroke="#ff9800" stroke-width="2" stroke-dasharray="4" marker-end="url(#arrow)"/>
  <path d="M720 555 L750 555" stroke="#ff9800" stroke-width="2" marker-end="url(#arrow)"/>
  
  <!-- Back to Context -->
  <path d="M820 530 L820 380 L550 380 L550 350" stroke="#4caf50" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  <text x="830" y="450" font-size="12" fill="#4caf50">返回 Top-K 结果</text>

  <!-- Definitions -->
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#333" />
    </marker>
  </defs>
</svg>